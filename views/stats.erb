<script src="<%= APP_PATH %>/app/vendor/chart.js/dist/Chart.bundle.min.js"></script>

<div class="col-md-4 col-md-offset-1">
	<div class="table-responsive" id="chart-layout">
    <%= _t "Checkout Statistics" %>
    <canvas id="chart-area"></canvas>
	</div>
</div>

<script>
  $(document).ready( function() {
    // getting checkout counts for tags
    // $.ajax({
    //   url: "<%= APP_PATH %>/tag/info/?id=" + tagID + "&expand=N"
    // })
    //   .success(function(response) {

    // });
        var dataChart = [], colorChart = [], labelChart = [];
     <% @tags.each { | tag | %>
        dataChart.push('<%= tag['count_items'] %>');              
        colorChart.push('<%= tag['color'].sub!("btn-","") %>');  
        labelChart.push('<%= tag['tag'] %>');            
      <% } %>

    console.log(dataChart);
    console.log(colorChart);
    console.log(labelChart);

    var config = {
      type: 'doughnut',
      data: {
        datasets: [{
          data: dataChart,
          backgroundColor: colorChart,
          label: '<%= _t "Checkout Statistics" %>'
        }],
        labels: labelChart
      },
      options: {
        responsive: true,
        legend: {
          position: 'top',
        },
        title: {
          display: false,
          //text: 'Chart.js Doughnut Chart'
        },
        animation: {
          animateScale: true,
          animateRotate: true
        }
      }
    };

    //window.onload = function() {
      var ctx = $('#chart-area')[0].getContext('2d');
      myDoughnut = new Chart(ctx, config);
      myDoughnut.update();
    //};
  });
  </script>